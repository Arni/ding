<?php
// $Id$

/**
 * @file ding_ting_search_result.module
 * Displays facet browser and search results from the Ting database.
 */

/**
 * Implementation of hook_theme().
 */
function ding_ting_search_result_theme() {
  return array(
    'ding_ting_search_result' => array(
      'arguments' => array('result' => NULL),
      'template' => 'ding_ting_search_result'
    ),
    'ding_ting_search_record' => array(
      'arguments' => array('record' => NULL),
      'template' => 'ding_ting_search_record'
    ),
    'ding_ting_facet_browser' => array(
      'arguments' => array('result' => NULL),
      'function' => 'ding_ting_facet_browser'
    ),
  );
}

function ding_ting_search_result_menu() {
	return array(
		'ding_ting_search_result' => array(
	    'title' => 'DING! Ting search results',
	    'description' => 'Lists facets and search results from the Ting database.',
	    'access arguments' => array('search content'),
			'page callback' => 'ding_ting_search_result_page',
	    'file' => 'ding_ting_search_result.pages.inc',
		),
		'ding_ting_ajax_search_result' => array(
	    'title' => 'DING! Ting AJAX search results',
	    'description' => 'Returns facets and search results from the Ting database for use through AJAX.',
	    'access arguments' => array('search content'),
			'page callback' => 'ding_ting_ajax_search_result_page',
	    'file' => 'ding_ting_search_result.pages.inc',
		),
	);
}

function ding_ting_facet_browser($result)
{
	//drupal_add_js(drupal_get_path('module', 'ding_ting_search_result') .'/js/pure/js/pure.js', 'module');
	drupal_add_js(drupal_get_path('module', 'ding_ting_search_result') .'/js/pure/js/purePacked.js', 'module');
	drupal_add_js(drupal_get_path('module', 'ding_ting_search_result') .'/js/prototype/object.js', 'module');
	drupal_add_js(drupal_get_path('module', 'ding_ting_search_result') .'/js/prototype/array.js', 'module');
	drupal_add_js(drupal_get_path('module', 'ding_ting_search_result') .'/js/ding_ting_facet_browser.js', 'module');
	drupal_add_css(drupal_get_path('module', 'ding_ting_search_result') .'/css/ding_ting_facet_browser.css', 'module');
	return '<div id="ding-facet-browser">
					</div>	
					<script type="text/javascript">
						Drupal.dingTingFacetBrowser("#ding-facet-browser",'.json_encode($result).');
					</script>';
}