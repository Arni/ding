<?php
// $Id$

/**
 * Rendering of Alma cart item.
 */
function theme_alma_cart_item($item) {
  $output = theme('image', $item['thumbnail_url'], '', $item['title'], array('class' => 'cart-item-thumbnail'), FALSE);
  $output .= '<span class="title">' . l($item['title'], 'ting/object/' . $item['ting_id'])  . '</span> ';
  $output .= t('by');
  $output .= ' <span class="author">' . $item['author'] . '</span>';
  $output .= ' <span class="type">' . $item['type'] . '</span>';
  return $output;
}

/**
 * Theme function to render reservation buttons for a TingClientObject.
 *
 * @param TingClientObject $object
 * @return string
 */
function theme_alma_cart_reservation_buttons($object) {
  // Leave out reservation buttons for some record types.
  if ($object->type == 'Tidsskrift') {
    return;
  }

  jquery_ui_add('ui.dialog');
  jquery_ui_theme_load();
  drupal_add_js(drupal_get_path('module', 'alma_cart') . '/alma_cart.buttons.js');

  if ($object->type == 'Netdokument') {
    $output = theme('item_list', array(
      l(t('View on-line'),  $object->online_url, array('attributes' => array('class' => 'view-online'))),
    ), NULL, 'ul', array('class' => 'buttons orange-button'));
    return $output;
  }
  // For all the object types we donâ€™t want to provide reservation
  // buttons for.
  elseif (in_array($object->type, array('Artikel'))) {
    return;
  }
  elseif (!empty($object->localId)) {
    // TODO: Check if item is reserved/in basket already.
    $output = theme('item_list', array(
      l(t('Reserve now'), 'alma/cart/reserve/' . $object->localId, array('attributes' => array('class' => 'reserve-now'))),
      l(t('Add to cart'), 'alma/cart/add/'  . $object->localId, array('attributes' => array('class' => 'add-to-cart'))),
    ), NULL, 'ul', array('class' => 'buttons alma-cart-buttons'));
    return $output;
  }
}

