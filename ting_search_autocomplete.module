<?php

/**
 * Implementation of hook_menu().
 */
function ting_search_autocomplete_menu() {
  $items = array();

  $items['ting/autocomplete'] = array(
    'title'            => 'Ting search autocomplete',
    'description'      => 'Returns a list of suggestions to use for autocompletion',
    'access arguments' => array('search content'),
    'page callback'    => 'ting_search_autocomplete_js',
    'type'             => MENU_CALLBACK,
    'file'             => 'ting_search_autocomplete.pages.inc',
  );

  return $items;
}

/**
 * Implementation of hook_flush_caches().
 */
function ting_search_autocomplete_flush_caches() {
	return array('cache_ting_search_autocomplete');
}

/**
 * Implements hook_form_alter()
 */
function ting_search_autocomplete_form_search_block_form_alter(&$form, &$form_state) {
  static $includes_loaded;
  if (!isset($includes_loaded))
  {
    $basePath = drupal_get_path('module', 'ting_search_autocomplete');
    drupal_add_js($basePath . '/js/jquery-autocomplete-1.0.2-mod/jquery.autocomplete.min.js');
    drupal_add_css($basePath . '/js/jquery-autocomplete-1.0.2-mod/jquery.autocomplete.css');

    drupal_add_js($basePath . '/js/ting_search_autocomplete.js');
    drupal_add_js(array('tingSearchAutocomplete' => array('path' => url('ting/autocomplete'))), 'setting');
    drupal_add_css($basePath . '/css/ting_search_autocomplete.css', 'module');

    $includes_loaded = true;
  }
  $form['#attributes'] = array('class' => 'ting-autocomplete');
}


