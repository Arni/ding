<?php

/**
 * Test to ensure that ting objects is available through ding_entity.
 */
class TingEntity extends DrupalWebTestCase {

  public static function getInfo() {
    return array(
      'name' => 'Ting via Ding entity',
      'description' => 'Test that getting a ting object works.',
      'group' => 'Ding!',
    );
  }

  function setUp() {
    $this->profile = 'ding2';
    parent::setUp(array('ding_entity', 'ting'));
    variable_set('ting_agency', '710100');
    variable_set('ting_search_url', 'http://didicas.dbc.dk/testbroend-1.2-opensearch-1.0/');
    variable_set('ting_scan_url', 'http://openscan.addi.dk/1.5/');
    variable_set('ting_spell_url', 'http://openspell.addi.dk/1.2/');
    variable_set('ting_recommendation_url', 'http://openadhl.addi.dk/1.1/');
  }

 /**
  * Test that getting a ting object works.
  */
  function testTingEntity() {
    $exists = module_exists('ding_entity');
    // This shouldn't fail, but provides a hint if there's profile related
    // issues.
    $this->assertTrue($exists, 'Ding entity is enabled.');
    $this->assertEqual(ding_entity_type(), 'ting_object', 'Entity type is right.');
    $entity = ding_entity_load('710100:25194853');
    $this->assertTrue(is_object($entity), 'Entity is an object.');
    $this->assertEqual($entity->title, 'Harry Potter og De Vises Sten', 'Entity has proper title.');
  }

   /**
  * Test that getting a ting collection works.
  */
  function testTingCollectionEntity() {
    $this->assertEqual(ding_entity_collection_type(), 'ting_collection', 'Collection type is right.');
    $entity = ding_entity_collection_load('710100:25194853');
    $this->assertTrue(is_object($entity), 'Collection is an object.');
    $this->assertEqual($entity->title, 'Harry Potter og De Vises Sten', 'Collection has proper title.');
    $this->assertTrue(is_array($entity->entities), 'Collection has an array.');
  }
}
